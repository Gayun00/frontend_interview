## 클로저
클로저는 이미 호출이 끝난 외부 함수의 변수를 내부에 있는 함수가 참조할 수 있는 것을 말한다.

클로저의 일반적인 조건으로는
1. 중첩함수가 상위 스코프의 식별자를 참조하고 있고
2. 중첩함수가 외부 함수보다 더 오래 유지되는 경우
클로저가 형성된다.

함수 내부에 있는 내부함수는 자신이 선언될 때 실행 컨텍스트가 생성되어 렉시컬 환경을 기억하기 때문에 자신의 상위 스코프인 외부함수의 변수에 접근할 수 있는 것이다.

```js
const x = 1;

function outer() {
  const x = 10;
  const inner = function () {console.log(x)};
  return inner;
}

const innerFunc = outer();
innerFunc(); //10
```

outer() 함수는 inner() 함수를 리턴한뒤 종료되었으나, inner()함수는 호출되면서 outer()함수의 변수인 x를 여전히 참조하여 10을 출력할 수 있다.

### 조금 더 자세히 알아보자.

[[Environment]]내부 슬롯과 Lexical Environment

#### 렉시컬 스코프
자바스크립트 엔진은 함수를 정의한 위치에 따라 상위 스코프를 결정하는데, 이를 렉시컬 스코프라고 한다.

호출되는 위치와는 상관없이 함수가 정의된 위치에 따라 상위 스코프를 기억한다.

#### 함수 내부 슬롯 [[Environment]]
함수 객체에는 [[Environment]]라는 내부 슬롯이 있는데,
함수 정의가 평가되어 함수 객체를 생성하는 단계에서 이 곳에 자신이 정의된 환경, 즉 상위 스코프의 참조를 저장한다.

#### 외부 렉시컬 환경에 대한 참조
함수가 호출되었을 때 [[Environment]]내부 슬롯에 저장되어 있던 상위 스코프의 참조값이 렉시컬 환경의 외부 렉시컬 환경에 대한 참조에 저장된다.

#### Garbage Collection
가비지 컬렉션은 자바스크립트 엔진이 내부적으로 사용하는 메모리 관리 시스템이다.
사용하지 않는 값들에 대한 메모리 영역을 정리해 불필요한 메모리 사용을 관리한다.
그러나 누군가가 참조하고 있는 메모리 공간은 해제하지 않는데,
- inner함수는 전역변수 innerFunc에 의해 참조되며
- outer함수의 렉시컬 환경은 inner함수의 [[Environment]]내부 슬롯에 의해 참조되고 있다.

따라서 inner함수의 내부에서 상위 스코프를 참조할 수 있고 식별자의 값을 변경할 수도 있다.